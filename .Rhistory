whiteplot
minGroups09 <- LikertData(positive, negative, neutral, minoritiesYN09)
minGroups09$neg$Response <- factor(minGroups09$neg$Response, levels=levels(minGroups09$neg$Response)[c(2,3,1)])
baseplot <- ggplot() + aes(InGroup, Freq, fill = Response, order=Response)+facet_wrap(~citystate, ncol=3)
baseplot <- baseplot  +geom_bar(data = minGroups09$neg, stat = "identity") + geom_bar(data = minGroups09$pos, stat = "identity")+ scale_fill_manual(values=colorsA, breaks=c("Very bad", "2", "3", "4", "Very good"),name="Response")
baseplot <- baseplot +coord_flip()
baseplot <- baseplot + scale_y_continuous(breaks=seq(from=-0.25, to=0.75, by=0.25), labels=percent)+ scale_x_discrete(labels=c("White", "Non-white"))
baseplot <- baseplot + xlab("") + ylab("")+ theme(legend.text=element_text(size=14), legend.title=element_text(size=16), axis.text.y=element_text(size=16), title=element_text(size=16), axis.text.x=element_text(size=14), strip.text=element_text(size=14))
#+ ggtitle("How is your community as a place for minorities?")
baseplot
minGroups10 <- LikertData(positive, negative, neutral, minoritiesYN10)
minGroups10$neg$Response <- factor(minGroups10$neg$Response, levels=levels(minGroups10$neg$Response)[c(2,3,1)])
minGroups08 <- LikertData(positive, negative, neutral, minoritiesYN08)
minGroups08$neg$Response <- factor(minGroups08$neg$Response, levels=levels(minGroups08$neg$Response)[c(2,3,1)])
# Come back here!! percentages are flipped
newDF09 <- FeelingsC(minGroups09$pos)
newDF09$year <- "2009"
names(newDF09) <- c("nonwhite", "white", "citystate", "racediffs", "year")
newDF08 <- FeelingsC(minGroups08$pos)
newDF08$year <- "2008"
names(newDF08) <- c("nonwhite", "white", "citystate", "racediffs", "year")
newDF <- rbind(newDF09, newDF08)
# Too much missing data to use 2010
newDF$year <- as.numeric(newDF$year)
masterData <- left_join(masterData, newDF)
horiz <- mean(newDF09$white)
vert <- mean(newDF09$nonwhite)
al <- ggplot(newDF09)+geom_vline(aes(xintercept=vert), color="grey") + geom_hline(aes(yintercept=horiz), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=white, x=nonwhite)) + geom_text(data = newDF09[newDF09$citystate %in% c("Duluth, MN", "Gary, IN", "Grand Forks, ND", "State College, PA"),], aes(y=white, x=nonwhite, label = citystate), vjust=-0.1, hjust=0, size=4) + xlab("Non-whites rating") + ylab("Whites rating") + xlim(0.4, 1) + ylim(0.4, 1)
al
packrat::restore(prompt = FALSE)
require(knitr)
require(dplyr)
require(ggplot2)
require(scales)
require(RColorBrewer)
require(ggmap)
require(xtable)
require(reshape2)
require(leaps)
n1 <- c("citystate", "InGroup", "Response", "n", "Freq", "year")
colors2 <- c("#f1a340", "#998ec3")
colors1 <- brewer.pal(5, "Spectral")
colorsA <- colors1[c(2,3,4,1,5)]
colorsB <- colors1[c(2,3,4,5,1)]
LikertData <- function(positive, negative, neutral=NULL, dataset){
pos <- dataset[dataset$Response %in% positive,]
neg <- dataset[dataset$Response %in% negative,]
if (is.null(neutral)==FALSE){
neu <- dataset[dataset$Response %in% neutral, ]
neu$Freq <- neu$Freq/2
pos <- rbind(pos, neu)
neg <- rbind(neg, neu)
} else {
neu <- NULL
}
neg$Freq <- -neg$Freq
neg$Response <- factor(neg$Response)
neg$Response <- factor(neg$Response, levels=rev(levels(neg$Response)))
pos$Response <- factor(pos$Response)
return(list(pos=pos, neu=neu, neg=neg))
}
FeelingsC <- function(dataset){
Feelings <- dataset %>% group_by(citystate, InGroup) %>% summarise(percents= sum(Freq))
Feelings <- data.frame(Feelings)
newDF <- data.frame(InGroup=NA, OutGroup=NA, citystate=levels(Feelings$citystate))
newDF$ratio <- (Feelings[Feelings$InGroup=="FALSE" | Feelings$InGroup=="No",]$percents) - (Feelings[Feelings$InGroup=="TRUE" | Feelings$InGroup=="Yes",]$percents)
newDF$InGroup <- Feelings[Feelings$InGroup=="TRUE" | Feelings$InGroup=="Yes",]$percents
newDF$OutGroup <- Feelings[Feelings$InGroup=="FALSE" | Feelings$InGroup=="No",]$percents
return(newDF)
}
races10 <- filter(sotc10, race != " " & race != "4" & race != "Don't Know") %>% group_by(race) %>% summarise(n = n()) %>% mutate(frac=prop.table(n), year=2010)
races10$race <- factor(races10$race)
levels(races10$race) <- c(levels(races10$race)[1:5], "Some other race", levels(races10$race)[7])
races09 <- filter(sotc09, race != " " & race != "4" & race != "Don't know") %>% group_by(race) %>% summarise(n = n()) %>% mutate(frac=prop.table(n), year=2009)
races09$race <- factor(races09$race)
races08 <- filter(sotc08, race != " " & race != "4" & race != "(DK)" & race != "None") %>% group_by(race) %>% summarise(n = n()) %>% mutate(frac=prop.table(n), year=2008)
races08$race <- factor(races08$race)
levels(races08$race) <- c("Hispanic", "More than one", "Refused", "American Indian or Alaskan", "Asian", "Black or African-American", "Native Hawaiian or other Pacific Islander", "Some other race", "White")
races <- rbind(races08, races09, races10)
raceOver <- ggplot(races) + aes(race, n) + geom_bar(stat="identity") + facet_wrap(~year,nrow=3)
raceOver <- raceOver +ylab("Number of respondents")+xlab("")
raceOver <- raceOver + theme(axis.text.y=element_text(size=20), title=element_text(size=24), axis.text.x=element_text(size=18),strip.text=element_text(size=25))
#+ ggtitle("Overall distribution of race responses")
raceOver + coord_flip()
minoritiesYN08 <- filter(sotc08, race != " " & race != "4" & race != "(DK)" & race != "None" & race != "(Refused)") %>% filter(minorities != "(DK)" & minorities != "(Refused)") %>% group_by(citystate, race != "White", minorities) %>% summarise(n = n()) %>% mutate(frac=prop.table(n), year=2008)
names(minoritiesYN08) <- n1
minoritiesYN09 <- filter(sotc09, race != " " & race != "4" & race != "Don't know" & race != "Refused") %>% filter(is.na(minorities)==FALSE) %>% group_by(citystate, race != "White", minorities) %>% summarise(n = n()) %>% mutate(frac=prop.table(n), year=2009)
names(minoritiesYN09) <- n1
minoritiesYN10 <- filter(sotc10, race != " " & race != "4" & race != "Don't Know" & race != "Refused") %>% filter(is.na(minorities)==FALSE) %>% group_by(citystate, race != "White", minorities) %>% summarise(n = n()) %>% mutate(frac=prop.table(n), year=2010)
names(minoritiesYN10) <- n1
whiteYN <- rbind(minoritiesYN08, minoritiesYN09, minoritiesYN10) %>% group_by(year, InGroup, Response) %>% summarise(tot = sum(n)) %>% mutate(newFreq=prop.table(tot))
whiteYN <- rename(whiteYN, Freq=newFreq, n=tot)
whiteYears <- LikertData(positive, negative, neutral, whiteYN)
neutral <- c("3")
positive <- c("Very good", "4")
negative <- c("2", "Very bad")
whiteYears <- LikertData(positive, negative, neutral, whiteYN)
whiteYears$neg$Response <- factor(whiteYears$neg$Response, levels=levels(whiteYears$neg$Response)[c(2,3,1)])
baseplot <- ggplot() + aes(InGroup, Freq, fill = Response, order=Response)+facet_wrap(~year, nrow=3)
baseplot <- baseplot + geom_bar(data = whiteYears$neg, stat = "identity") + geom_bar(data = whiteYears$pos, stat = "identity") + scale_fill_manual(breaks=c("Very bad", "2", "3", "4", "Very good"), values=colorsA, name="Response")
baseplot <- baseplot +coord_flip()
baseplot <- baseplot + scale_y_continuous(breaks=seq(from=-0.25, to=0.75, by=0.25), labels=percent)+ scale_x_discrete(labels=c("White", "Non-white")) + theme(legend.text=element_text(size=14), legend.title=element_text(size=16), axis.text.y=element_text(size=16), title=element_text(size=16), axis.text.x=element_text(size=14), strip.text=element_text(size=14))
baseplot <- baseplot + xlab("") + ylab("")
#+ ggtitle("How is your community as a place for racial and ethnic minorities?")
baseplot
al <- ggplot(newDF09)+geom_vline(aes(xintercept=vert), color="grey") + geom_hline(aes(yintercept=horiz), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=white, x=nonwhite)) + geom_text(data = newDF09[newDF09$citystate %in% c("Duluth, MN", "Gary, IN", "Grand Forks, ND", "State College, PA"),], aes(y=white, x=nonwhite, label = citystate), vjust=c(-0.4, -0.4, 0.4, -0.6), hjust=0, size=4) + xlab("Non-whites rating") + ylab("Whites rating") + xlim(0.4, 1) + ylim(0.4, 1)
help(cor)
baseplot <- ggplot() + aes(InGroup, Freq, fill = Response, order=Response)+facet_wrap(~citystate, ncol=3)
baseplot <- baseplot  +geom_bar(data = minGroups08$neg, stat = "identity") + geom_bar(data = minGroups08$pos, stat = "identity")+ scale_fill_manual(values=colorsA, breaks=c("Very bad", "2", "3", "4", "Very good"),name="Response")
minGroups08 <- LikertData(positive, negative, neutral, minoritiesYN08)
minGroups08$neg$Response <- factor(minGroups08$neg$Response, levels=levels(minGroups08$neg$Response)[c(2,3,1)])
baseplot <- ggplot() + aes(InGroup, Freq, fill = Response, order=Response)+facet_wrap(~citystate, ncol=3)
baseplot <- baseplot  +geom_bar(data = minGroups08$neg, stat = "identity") + geom_bar(data = minGroups08$pos, stat = "identity")+ scale_fill_manual(values=colorsA, breaks=c("Very bad", "2", "3", "4", "Very good"),name="Response")
baseplot <- baseplot +coord_flip()
baseplot <- baseplot + scale_y_continuous(breaks=seq(from=-0.25, to=0.75, by=0.25), labels=percent)+ scale_x_discrete(labels=c("White", "Non-white"))
baseplot <- baseplot + xlab("") + ylab("")+ theme(legend.text=element_text(size=14), legend.title=element_text(size=16), axis.text.y=element_text(size=16), title=element_text(size=16), axis.text.x=element_text(size=14), strip.text=element_text(size=14))
baseplot
al <- ggplot(newDF08)+geom_vline(aes(xintercept=vert), color="grey") + geom_hline(aes(yintercept=horiz), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=white, x=nonwhite)) + geom_text(data = newDF09[newDF09$citystate %in% c("Duluth, MN", "Gary, IN", "Grand Forks, ND", "State College, PA"),], aes(y=white, x=nonwhite, label = citystate), vjust=c(-0.6, -0.4, 1.3, -0.6), hjust=0, size=4) + xlab("Non-whites rating") + ylab("Whites rating") + xlim(0.4, 1) + ylim(0.4, 1)
newDF08 <- FeelingsC(minGroups08$pos)
newDF08$year <- "2008"
names(newDF08) <- c("nonwhite", "white", "citystate", "racediffs", "year")
al <- ggplot(newDF08)+geom_vline(aes(xintercept=vert), color="grey") + geom_hline(aes(yintercept=horiz), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=white, x=nonwhite)) + geom_text(data = newDF09[newDF09$citystate %in% c("Duluth, MN", "Gary, IN", "Grand Forks, ND", "State College, PA"),], aes(y=white, x=nonwhite, label = citystate), vjust=c(-0.6, -0.4, 1.3, -0.6), hjust=0, size=4) + xlab("Non-whites rating") + ylab("Whites rating") + xlim(0.4, 1) + ylim(0.4, 1)
al <- ggplot(newDF08)+geom_vline(aes(xintercept=vert), color="grey") + geom_hline(aes(yintercept=horiz), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=white, x=nonwhite)) + geom_text(data = newDF08[newDF08$citystate %in% c("Duluth, MN", "Gary, IN", "Grand Forks, ND", "State College, PA"),], aes(y=white, x=nonwhite, label = citystate), vjust=c(-0.6, -0.4, 1.3, -0.6), hjust=0, size=4) + xlab("Non-whites rating") + ylab("Whites rating") + xlim(0.4, 1) + ylim(0.4, 1)
al
vert <- mean(newDF08$nonwhite)
horiz <- mean(newDF08$white)
al <- ggplot(newDF08)+geom_vline(aes(xintercept=vert), color="grey") + geom_hline(aes(yintercept=horiz), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=white, x=nonwhite)) + geom_text(data = newDF08[newDF08$citystate %in% c("Duluth, MN", "Gary, IN", "Grand Forks, ND", "State College, PA"),], aes(y=white, x=nonwhite, label = citystate), vjust=c(-0.6, -0.4, 1.3, -0.6), hjust=0, size=4) + xlab("Non-whites rating") + ylab("Whites rating") + xlim(0.4, 1) + ylim(0.4, 1)
al
baseplot <- ggplot() + aes(InGroup, Freq, fill = Response, order = Response) + facet_wrap(~citystate, ncol=3)
baseplot <- baseplot  + geom_bar(data = seniorGroup10$neg, stat = "identity") + geom_bar(data = seniorGroup09$pos, stat = "identity") + scale_fill_manual(breaks=c("Very bad", "2", "3", "4", "Very good"), values=colorsA, name="Response")
baseplot <- baseplot  + geom_bar(data = seniorGroup09$neg, stat = "identity") + geom_bar(data = seniorGroup09$pos, stat = "identity") + scale_fill_manual(breaks=c("Very bad", "2", "3", "4", "Very good"), values=colorsA, name="Response")
seniorGroup09 <- filter(sotc09, age != "NA") %>% group_by(citystate, age >= 62, seniors) %>% summarise(n = n()) %>% mutate(frac=prop.table(n), year=2009)
names(seniorGroup09) <- n1
seniorGroup09 <- LikertData(positive, negative, neutral, seniorGroup09)
seniorGroup09$neg$Response <- factor(seniorGroup09$neg$Response, levels=levels(seniorGroup09$neg$Response)[c(2,3,1)])
baseplot <- ggplot() + aes(InGroup, Freq, fill = Response, order = Response) + facet_wrap(~citystate, ncol=3)
baseplot <- baseplot  + geom_bar(data = seniorGroup09$neg, stat = "identity") + geom_bar(data = seniorGroup09$pos, stat = "identity") + scale_fill_manual(breaks=c("Very bad", "2", "3", "4", "Very good"), values=colorsA, name="Response")
baseplot <- baseplot +coord_flip()
baseplot <- baseplot + scale_y_continuous(breaks=seq(from=-0.25, to=0.75, by=0.25), labels=percent)+ scale_x_discrete(labels=c("Non-seniors", "Seniors"))
baseplot <- baseplot  + xlab("") + ylab("")+theme(legend.text=element_text(size=14), legend.title=element_text(size=16), axis.text.y=element_text(size=16), title=element_text(size=16), axis.text.x=element_text(size=12),strip.text=element_text(size=14))
baseplot
FeelingsC
tmp<- FeelingsC(seniorGroup10$pos)
tmp<- FeelingsC(seniorGroup09$pos)
head(tmp)
names(totPos) <- c("Seniors", "Nonseniors","citystate", "seniordiffs")
totPos <- FeelingsC(seniorGroup09$pos)
names(totPos) <- c("Seniors", "Nonseniors","citystate", "seniordiffs")
horiz <- mean(totPos$Nonseniors)
vert <- mean(totPos$Seniors)
sr <- ggplot(totPos)+geom_vline(aes(xintercept=vert), color="grey") + geom_hline(aes(yintercept=horiz), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=Nonseniors, x=Seniors)) + geom_text(data = totPos[totPos$citystate %in% c("Milledgeville, GA", "Gary, IN", "Bradenton, FL"),], aes(y=Nonseniors, x=Seniors, label = citystate),vjust=-0.4, hjust=c(1,0,0), size=4) + xlab("Senior rating") + ylab("Non-senior rating")
sr
which(totPos$Senior<0.8 & totPos$Nonseniors < 0.8)
totPos[which(totPos$Senior<0.8 & totPos$Nonseniors < 0.8),]
head(comp09)
kidGroup10 <- filter(sotc10, children == "Yes" | children == "No", families_kids != "NA") %>% group_by(citystate, children, families_kids) %>% summarise(n = n()) %>% mutate(frac=prop.table(n), year=2010)
names(kidGroup10) <- n1
kidGroups <- LikertData(positive, negative, neutral, kidGroup10)
kidGroups$neg$Response <- factor(kidGroups$neg$Response, levels=levels(kidGroups$neg$Response)[c(2,3,1)])
kidGroup09 <- filter(sotc09, children == "Yes" | children == "No", families_kids != "NA") %>% group_by(citystate, children, families_kids) %>% summarise(n = n()) %>% mutate(frac=prop.table(n), year=2009)
names(kidGroup09) <- n1
kidGroup08 <- filter(sotc08, children == "Yes" | children == "No", families_kids != "NA" & families_kids != "(DK)" & families_kids != "(Refused)") %>% group_by(citystate, children, families_kids) %>% summarise(n = n()) %>% mutate(frac=prop.table(n), year=2008)
names(kidGroup08) <- n1
kidYears <- rbind(kidGroup08, kidGroup09, kidGroup10)
forMaster <- LikertData(positive, negative, neutral, kidYears)
forMaster$neg$Response <- factor(forMaster$neg$Response, levels=levels(forMaster$neg$Response)[c(2,3,1)])
forM <- filter(forMaster$pos, year==2009)
forM <- tbl_df(forM)
comp09 <- FeelingsC(forM) %>% mutate(year="2009")
head(comp10)
head(comp09)
kd <- ggplot(comp09)+geom_vline(aes(xintercept=mean(comp09$InGroup)), color="grey") + geom_hline(aes(yintercept=mean(comp09$OutGroup)), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=OutGroup, x=InGroup))
kd
which(comp09$InGroup<0.6)
comp09[12,]
which(comp09$InGroup>0.9)
comp09[c(13,24),]
comp09[which(comp09$InGroup>0.85 & comp09$OutGroup>0.85),]
kd <- ggplot(comp09)+geom_vline(aes(xintercept=mean(comp09$InGroup)), color="grey") + geom_hline(aes(yintercept=mean(comp09$OutGroup)), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=OutGroup, x=InGroup)) + geom_text(data = totPos[totPos$citystate %in% c("Grand Forks, ND", "Gary, IN", "St. Paul, MN"),], aes(y=OutGroup, x=InGroup, label = citystate),vjust=c(-0.4,-0.4,1), hjust=c(1,0,0), size=4)
kd
names(comp09)
kd <- ggplot(comp09)+geom_vline(aes(xintercept=mean(comp09$InGroup)), color="grey") + geom_hline(aes(yintercept=mean(comp09$OutGroup)), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=OutGroup, x=InGroup)) + geom_text(data = totPos[totPos$citystate %in% c("Grand Forks, ND", "Gary, IN", "St. Paul, MN"),], aes(y=OutGroup, x=InGroup, label = citystate),vjust=c(-0.4,-0.4,1), hjust=c(1,0,0), size=4)
kd <- ggplot(comp09)+geom_vline(aes(xintercept=mean(comp09$InGroup)), color="grey") + geom_hline(aes(yintercept=mean(comp09$OutGroup)), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=OutGroup, x=InGroup)) + geom_text(data = totPos[totPos$citystate %in% c("Grand Forks, ND", "Gary, IN", "St. Paul, MN"),], aes(y=OutGroup, x=InGroup, label = citystate),vjust=c(-0.4,-0.4,1), hjust=c(1,0,0), size=4) + xlab("Families with children") + ylab("Childless households")
kd
kd <- ggplot(comp09) + geom_vline(aes(xintercept=mean(comp09$InGroup)), color="grey") + geom_hline(aes(yintercept=mean(comp09$OutGroup)), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(comp09, aes(y=OutGroup, x=InGroup)) + geom_text(data = totPos[totPos$citystate %in% c("Grand Forks, ND", "Gary, IN", "St. Paul, MN"),], aes(y=OutGroup, x=InGroup, label = citystate),vjust=c(-0.4,-0.4,1), hjust=c(1,0,0), size=4) + xlab("Families with children") + ylab("Childless households")
kd <- ggplot(comp09) + geom_vline(aes(xintercept=mean(comp09$InGroup)), color="grey") + geom_hline(aes(yintercept=mean(comp09$OutGroup)), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(data=comp09, aes(y=OutGroup, x=InGroup)) + geom_text(data = totPos[totPos$citystate %in% c("Grand Forks, ND", "Gary, IN", "St. Paul, MN"),], aes(y=OutGroup, x=InGroup, label = citystate),vjust=c(-0.4,-0.4,1), hjust=c(1,0,0), size=4) + xlab("Families with children") + ylab("Childless households")
kd
kd <- ggplot(comp09) + geom_vline(aes(xintercept=mean(comp09$InGroup)), color="grey") + geom_hline(aes(yintercept=mean(comp09$OutGroup)), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=OutGroup, x=InGroup)) + geom_text(data = comp09[comp09$citystate %in% c("Grand Forks, ND", "Gary, IN", "St. Paul, MN"),], aes(y=OutGroup, x=InGroup, label = citystate),vjust=c(-0.4,-0.4,1), hjust=c(1,0,0), size=4) + xlab("Families with children") + ylab("Childless households")
kd
kd <- ggplot(comp09) + geom_vline(aes(xintercept=mean(comp09$InGroup)), color="grey") + geom_hline(aes(yintercept=mean(comp09$OutGroup)), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=OutGroup, x=InGroup)) + geom_text(data = comp09[comp09$citystate %in% c("Grand Forks, ND", "Gary, IN", "St. Paul, MN"),], aes(y=OutGroup, x=InGroup, label = citystate),vjust=c(-0.4,-0.4,1), hjust=c(0,1,0), size=4) + xlab("Families with children") + ylab("Childless households")
kd
al <- ggplot(newDF09)+geom_vline(aes(xintercept=vert), color="grey") + geom_hline(aes(yintercept=horiz), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=white, x=nonwhite)) + geom_text(data = newDF09[newDF09$citystate %in% c("Duluth, MN", "Gary, IN", "Grand Forks, ND", "State College, PA"),], aes(y=white, x=nonwhite, label = citystate), vjust=c(-0.6, -0.4, 1.3, -0.6), hjust=0, size=4) + xlab("Non-whites rating") + ylab("Whites rating") + xlim(0.4, 1) + ylim(0.4, 1)
al
head(masterData)
source('~/.active-rstudio-document', echo=TRUE)
head(masterData)
ggplot(masterData, aes(y=communitysat, x=racediffs)) + geom_point()
ggplot(masterData, aes(y=communitysat, x=racediffs)) + geom_point()+stat_smooth(method="lm")
cor(masterData$communitysat, masterData$racediffs)
cor(masterData$communitysat, masterData$racediffs, na.rm=TRUE)
cor(masterData$communitysat, masterData$racediffs, complete.cases=TRUE)
help(cor)
cor(masterData$communitysat, masterData$racediffs, use="complete.obs")
cor(masterData$communitysat, abs(masterData$racediffs), use="complete.obs")
ggplot(masterData, aes(y=communitysat, x=abs(racediffs))) + geom_point()+stat_smooth(method="lm")
ggplot(subset(masterData, year==2009), aes(y=communitysat, x=abs(racediffs))) + geom_point()+stat_smooth(method="lm", se=FALSE)
ggplot(subset(masterData, year==2009), aes(y=communitysat, x=seniordiffs, label=citystate)) + geom_point()
ggplot(subset(masterData, year==2009), aes(y=communitysat, x=abs(seniordiffs), label=citystate)) + geom_point()
ggplot(masterData, aes(y=communitysat, x=seniordiffs, label=citystate)) + geom_point()
ggplot(masterData, aes(y=communitysat, x=abs(seniordiffs), label=citystate)) + geom_point()
relationplot2 <- ggplot(subset(masterData, year==2009), aes(y=communitysat, x=abs(seniordiffs), label=citystate)) + geom_point()+xlab("Absolute difference between senior and non-senior ratings")+ylab("Community satisfaction") + xlim(0, 0.3)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(subset(masterData, year==2009), aes(y=communitysat, x=abs(seniordiffs), label=citystate)) + geom_point()+xlab("Absolute difference between senior and non-senior ratings")+ylab("Community satisfaction") + xlim(0, 0.2)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=abs(seniordiffs), label=citystate)) + geom_point()+xlab("Absolute difference between senior and non-senior ratings")+ylab("Community satisfaction") + xlim(0, 0.2)
relationplot2+stat_smooth(method="lm", se=FALSE)
horiz <- mean(masterData$white)
vert <- mean(masterData$nonwhite)
al <- ggplot(masterData)+geom_vline(aes(xintercept=vert), color="grey") + geom_hline(aes(yintercept=horiz), color="grey") + geom_abline(intercept=0, slope=1) + geom_point(aes(y=white, x=nonwhite))
al
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=abs(racediffs), label=citystate)) + geom_point()+xlab("Absolute difference between minority and white ratings")+ylab("Community satisfaction") + xlim(0, 0.3)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- relationplot2 + geom_text(data = CA3[CA3$citystate %in% c( "Gary, IN", "Duluth, MN", "State College, PA", "Bradenton, FL", "Detroit, MI" , "Macon, GA", "Miami, FL", "Wichita, KS", "Grand Forks, ND"),], aes(x=diffs,y=communitysat, label = citystate),hjust=-0.1, vjust=-0.4)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- relationplot2 + geom_text(data = masterData[masterData$citystate %in% c( "Gary, IN", "Duluth, MN", "State College, PA", "Bradenton, FL", "Detroit, MI" , "Macon, GA", "Miami, FL", "Wichita, KS", "Grand Forks, ND"),], aes(x=abs(racediffs), y=communitysat, label = citystate),hjust=-0.1, vjust=-0.4)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=abs(racediffs), label=citystate)) + geom_point()+xlab("Absolute difference between minority and white ratings")+ylab("Community satisfaction") + xlim(0, 0.3)
relationplot2 <- relationplot2 + geom_text(data = masterData[masterData$citystate %in% c( "Gary, IN", "Duluth, MN", "State College, PA", "Bradenton, FL", "Detroit, MI" , "Macon, GA", "Miami, FL", "Wichita, KS", "Grand Forks, ND"),], aes(x=abs(racediffs), y=communitysat, label = citystate),hjust=-0.1, vjust=-0.4)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=abs(racediffs), label=citystate)) + geom_point()+xlab("Absolute difference between minority and white ratings")+ylab("Community satisfaction") + xlim(0, 0.3)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=abs(racediffs), label=citystate)) + geom_point()+xlab("Absolute difference between minority and white ratings")+ylab("Community satisfaction") + xlim(0, 0.25)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=abs(seniordiffs), label=citystate)) + geom_point()+xlab("Absolute difference between senior and non-senior ratings")+ylab("Community satisfaction") + xlim(0, 0.2)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=abs(kiddiffs), label=citystate)) + geom_point()+xlab("Absolute difference between families with children and childless household ratings")+ylab("Community satisfaction") + xlim(0, 0.2)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=kiddiffs, label=citystate)) + geom_point()+xlab("Absolute difference between families with children and childless household ratings")+ylab("Community satisfaction") + xlim(0, 0.2)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=kiddiffs, label=citystate)) + geom_point()+xlab("Absolute difference between families with children and childless household ratings")+ylab("Community satisfaction") + xlim(0, 0.2)
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=kiddiffs, label=citystate)) + geom_point()+xlab("Absolute difference between families with children and childless household ratings")+ylab("Community satisfaction")
relationplot2+stat_smooth(method="lm", se=FALSE)
relationplot2 <- ggplot(masterData, aes(y=communitysat, x=abs(kiddiffs), label=citystate)) + geom_point()+xlab("Absolute difference between families with children and childless household ratings")+ylab("Community satisfaction")
relationplot2+stat_smooth(method="lm", se=FALSE)
names(masterData)
m1 <- lm(communitysat~abs(racediffs)+abs(seniordiffs)+kiddiffs, data=masterData)
summary(m1)
names(masterData)
m1 <- lm(communitysat~.-citystate-year-nonwhite-white-seniors-nonseniors-withKids-noKids, data=masterData)
summary(m1)
m1 <- lm(communitysat~registered_vote+volunteer+public_meeting+voted_local+worked_change+abs(racediffs)+abs(seniordiffs)+kiddiffs, data=masterData)
summary(m1)
vif(m1)
library(car)
vif(m1)
m1 <- lm(communitysat~abs(racediffs)+abs(seniordiffs)+kiddifs, data=masterData)
m1 <- lm(communitysat~abs(racediffs)+abs(seniordiffs)+kiddiffs, data=masterData)
summary(m1)
m1 <- lm(communitysat~abs(racediffs)+nonwhite+seniors+abs(seniordiffs)+withKids+kiddiffs, data=masterData)
summary(m1)
vif(m1)
m1 <- lm(communitysat~abs(racediffs)+white+nonseniors+abs(seniordiffs)+noKids+kiddiffs, data=masterData)
summary(m1)
m1 <- lm(communitysat~abs(racediffs), data=masterData)
summary(m1)
m1 <- lm(communitysat~racediffs, data=masterData)
summary(m1)
m1 <- lm(communitysat~abs(racediffs)+abs(seniordiffs)+kiddiffs, data=masterData)
summary(m1)
help(xtable)
xtable(summary(m1))
masterData$absrace <- abs(racediffs)
masterData$abssenior <- abs(seniordiffs)
masterData$absrace <- abs(masterData$racediffs)
masterData$abssenior <- abs(masterData$seniordiffs)
masterData <- rename(masterData, '|MK_R|'=absrace, '|MK_S|'=abssenior, '|MK_C|'=kiddifs, 'Community satisfaction'=communitysat)
masterData <- rename(masterData, '|MK_R|'=absrace, '|MK_S|'=abssenior, '|MK_C|'=kiddiffs, 'Community satisfaction'=communitysat)
m1 <- lm('Community satisfaction'~'|MK_R|'+'|MK_S|'+'|MK_C|', data=masterData)
m1 <- lm(`Community satisfaction`~`|MK_R|`+`|MK_S|`+`|MK_C|`, data=masterData)
summary(m1)
masterData$absrace <- abs(masterData$racediffs)
masterData$abssenior <- abs(masterData$seniordiffs)
masterData <- rename(masterData, '|MK_R|'=absrace, '|MK_S|'=abssenior, 'MK_C'=kiddiffs, 'Community satisfaction'=communitysat)
names(masterData)
m5 <- lm(`Community satisfaction`~racediffs+nonwhite+racediffs*nonwhite, data=masterData)
summary(m5)
vif(m5)
m2 <- lm(communitysat~.-citystate-year-seniors-nonseniors-withKids-noKids-nonwhite-white, data=masterData)
m2 <- lm(`Community satisfaction`~.-citystate-year-seniors-nonseniors-withKids-noKids-nonwhite-white, data=masterData)
summary(m2)
source('~/.active-rstudio-document', echo=TRUE)
head(masterData)
m2 <- lm(`Community satisfaction`~.-citystate-year-seniors-nonseniors-withKids-noKids-nonwhite-white-racediffs-seniordiffs, data=masterData)
summary(m2)
vif(m2)
help(glm)
install.packages("betareg")
library(betareg)
?betareg
m3 <- betareg(`Community satisfaction`~.-citystate-year-seniors-nonseniors-withKids-noKids-nonwhite-white-racediffs-seniordiffs, data=masterData)
summary(m3)
data("GasolineYield", package = "betareg")
gy <- betareg(yield ~ batch + temp, data = GasolineYield)
summary(gy)
summary(m3)
help(glm)
m3 <- lm(`Community satisfaction`~registered_vote+volunteer+worked_change, data=masterData)
summary(m3)
vif(m3)
m3 <- lm(logit(`Community satisfaction`)~registered_vote+volunteer+worked_change, data=masterData)
summary(m3)
plogis(1.7563)
plogis(-5.37)
?plogis
plogis(qlogis(0.6))
qlogis(plogis(0.6))
m3 <- betareg(`Community satisfaction`~.-citystate-year-seniors-nonseniors-withKids-noKids-nonwhite-white-racediffs-seniordiffs, data=masterData)
summary(m3)
plogis( -9.5243   )
rlogis( -9.5243   )
plogis( -9.5243   )
plogis(6.4712 )
library(corrplot)
install.packages("corrplot")
library(corrplot)
M <- cor(filter(masterData, select=-c(citystate, year)))
M <- cor(filter(masterData, select=-c("citystate", "year")))
help(filter)
M <- cor(select(masterData, select=-c("citystate", "year")))
M <- cor(select(masterData, -c("citystate", "year")))
M <- cor(select(masterData, -c(citystate, year)))
corrplot(M)
names(masterData)
M <- cor(select(masterData, -c(citystate, year, racediffs, seniordiffs)))
names(masterData)
corrplot(M)
M <- cor(select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white)))
corrplot(M)
M
M <- cor(select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)))
M
corrplot(M)
qplot(x=Var1, y=Var2, data=melt(cor(select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`))), fill=value, geom="tile")
)
qplot(x=Var1, y=Var2, data=melt(cor(select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)))), fill=value, geom="tile")
?geom_
help(ggplot2)
cp <- cp + geom_tile(fill=value)
cp <- ggplot(data=melt(cor(select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)))))
cp <- cp + geom_tile(fill=value)
melted <- melt(cor(select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`))))
cp <- ggplot(data=melted)
cp <- cp + geom_tile(fill=value)
head(melted)
cp <- cp + geom_tile(x=Var1, y=Var2, fill=value)
cp <- ggplot(data=melted, aes(x=Var1, y=Var2))
cp <- cp + geom_tile(fill=value)
cp <- ggplot(data=melted, aes(x=Var1, y=Var2)) + geom_tile(fill=value)
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value)) + geom_tile()
cp
?brewer.pal
color.brewer(6, type="div")
brewer.pal(6, type="div")
display.brewer.all(6, type="div")
display.brewer.all(7, type="div")
brewer.pal(6, "PRGn")
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_manual(values=brewer.pal(6, "PRGn"))
cp
help(scale_fill_manual)
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
cp
melted <- upper.tri(melt(cor(select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)))))
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
melted <- upper.tri(melt(cor(select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)))), diag=TRUE)
class(melted)
melted <- as.dataframe(melted)
melted <- data.frame(melted)
melted
melted <- select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)) %>% cor() %>% melt()
melted
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
cp <- cp + scale_x_discrete(labels=c("Community satisfaction", "Registered to vote", "Volunteered", "Attended a public meeting", "Voted in a local election", "Worked to make change", "Senior rating", "Non-Senior rating", "Families with children rating", "Childless household rating", "MK_C", "|MK_S|")
cp
cp <- cp + scale_x_discrete(labels=c("Community satisfaction", "Registered to vote", "Volunteered", "Attended a public meeting", "Voted in a local election", "Worked to make change", "Senior rating", "Non-Senior rating", "Families with children rating", "Childless household rating", "MK_C", "|MK_S|"))
cp
melted <- select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)) %>% group_by(year) %>% cor() %>% melt()
head(masterData)
melted <- select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)) %>% group_by(year) %>% cor() %>% melt()
melted <- select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)) %>% group_by(year)
melted <- select(masterData, -c(citystate, year, racediffs, seniordiffs,nonwhite,white,`|MK_R|`))
head(melted)
melted <- select(masterData, -c(citystate, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)) %>% group_by(year)
melted <- select(masterData, -c(citystate, racediffs, seniordiffs,nonwhite,white,`|MK_R|`)) %>% group_by(year) %>% cor() %>% melt()
melted
help(melt)
melted <- select(masterData, -c(citystate, racediffs, seniordiffs)) %>% group_by(year)
melted
head(melted)
melted <- select(masterData, -c(citystate, racediffs, seniordiffs)) %>% group_by(year) %>% mutate(value=cor())
melted <- select(masterData, -c(citystate, racediffs, seniordiffs))
head(melted)
dim(masterData)
melted <- masterData %>% group_by(year)
melted
melted <- masterData %>% group_by(year) %>% mutate(cor=cor())
melt08 <- select(masterData, year==2008)
melt08 <- filter(masterData, year==2008)
head(melt08)
melt08 <- filter(masterData, year==2008) %>% select(-citystate) %>% cor()
names(masterData)
filter(masterData, year==2008) %>% select(-citystate) %>% cor() %>% melt()
melted <- select(masterData, -c(citystate, racediffs, seniordiffs)) %>% group_by(year) %>% mutate(value=cor())
source('~/.active-rstudio-document', echo=TRUE)
head(masterData)
melted <- select(masterData, -c(citystate, racediffs, seniordiffs)) %>% cor() %>% melt()
melt08 <- filter(masterData, year==2008) %>% select(-citystate) %>% cor %>% melt()
melt08 <- filter(masterData, year==2008) %>% select(-citystate)
melt08
melt08 <- filter(masterData, year==2008) %>% select(-citystate, -year) %>% cor %>% melt()
melt08
melt09 <- filter(masterData, year==2009) %>% select(-citystate, -year) %>% cor %>% melt()
melt10 <- filter(masterData, year==2010) %>% select(-citystate, -year) %>% cor %>% melt()
head(melt08)
melt08 <- filter(masterData, year==2008) %>% select(-citystate, -year) %>% cor() %>% melt()
head(melt08)
filter(masterData, year==2008) %>% select(-citystate, -year) %>% cor() %>% melt()
melt08 <- filter(masterData, year==2008) %>% select(-citystate, -year) %>% cor() %>% melt()
head(melt08)
dim(melt08)
melt08 <- filter(masterData, year==2008) %>% select(-citystate, -year) %>% cor() %>% melt() %>% mutate(year=2008)
dim(melt08)
head(melt08)
melted <- rbind(melt08, melt09, mel10)
melted <- rbind(melt08, melt09, melt10)
melt08 <- filter(masterData, year==2008) %>% select(-citystate, -year) %>% cor() %>% melt() %>% mutate(year=2008)
melt09 <- filter(masterData, year==2009) %>% select(-citystate, -year) %>% cor() %>% melt() %>% mutate(year=2009)
melt10 <- filter(masterData, year==2010) %>% select(-citystate, -year) %>% cor() %>% melt() %>% mutate(year=2010)
melted <- rbind(melt08, melt09, melt10)
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value))
cp <- cp  + facet(~year) geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
cp <- cp + scale_x_discrete(labels=c("Community satisfaction", "Registered to vote", "Volunteered", "Attended a public meeting", "Voted in a local election", "Worked to make change", "Senior rating", "Non-Senior rating", "Families with children rating", "Childless household rating", "MK_C", "|MK_S|"))
cp <- cp  + facet_wrap(~year) geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
cp <- cp  + facet_wrap(~year) + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
cp <- cp + scale_x_discrete(labels=c("Community satisfaction", "Registered to vote", "Volunteered", "Attended a public meeting", "Voted in a local election", "Worked to make change", "Senior rating", "Non-Senior rating", "Families with children rating", "Childless household rating", "MK_C", "|MK_S|"))
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value))
cp <- cp  + facet_wrap(~year) + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
cp <- cp + scale_x_discrete(labels=c("Community satisfaction", "Registered to vote", "Volunteered", "Attended a public meeting", "Voted in a local election", "Worked to make change", "Senior rating", "Non-Senior rating", "Families with children rating", "Childless household rating", "MK_C", "|MK_S|"))
cp
melted <- select(masterData, -citystate, -year) %>% cor() %>% melt()
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value))
cp +geom_tile()
help(cor)
melted <- select(masterData, -citystate, -year) %>% cor(use="complete.obs") %>% melt()
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value))
cp +geom_tile()
cp <- cp + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
cp <- cp + scale_x_discrete(labels=c("Community satisfaction", "Registered to vote", "Volunteered", "Attended a public meeting", "Voted in a local election", "Worked to make change", "Senior rating", "Non-Senior rating", "Families with children rating", "Childless household rating", "MK_C", "|MK_S|"))
cp
names(masterData)
varnames <- c("Community satisfaction", "Registered to vote", "Volunteered", "Attended a public meeting", "Voted in a local election", "Worked to make change", "Non-White rating", "White rating", "MK_R", "Senior rating", "Non-Senior rating", "MK_S", "Families with children rating", "Childless household rating", "MK_C")
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value))
cp <- cp + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
cp <- cp + scale_x_discrete(labels=varnames)+scale_y_discrete(labels=varnames)
cp
cp <- cp + scale_x_discrete(labels=varnames)+scale_y_discrete(labels=varnames, name="Correlation") +xlab("") +ylab("")
cp
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value))
cp <- cp + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
cp <- cp + scale_x_discrete(labels=varnames)+scale_y_discrete(labels=varnames) +xlab("") +ylab("")+guide_legend(title="Correlation")
cp
cp <- cp + scale_x_discrete(labels=varnames)+scale_y_discrete(labels=varnames) +xlab("") + ylab("") + guide_legend(title="Correlation")
cp <- cp + scale_x_discrete(labels=varnames)+scale_y_discrete(labels=varnames) +xlab("") + ylab("") + guides(title="Correlation")
cp
cp <- cp + scale_x_discrete(labels=varnames)+scale_y_discrete(labels=varnames) +xlab("") + ylab("") + guides(guide_legend(title="Correlation"))
cp
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value))
cp <- cp + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837")
cp <- cp + scale_x_discrete(labels=varnames)+scale_y_discrete(labels=varnames) +xlab("") + ylab("") + guides(guide_legend(title="Correlation"))
cp
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value))
cp <- cp + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837", name="Correlation")
cp <- cp + scale_x_discrete(labels=varnames)+scale_y_discrete(labels=varnames) +xlab("") + ylab("")
cp
cp + opts(axis.text.x=theme_text(angle=-90))
help(theme)
cp + theme(axis.text.x=theme_text(angle=-90))
cp + theme(axis.text.x=element_text(angle=-90))
cp + theme(axis.text.x=element_text(angle=-90, hjust=1))
cp + theme(axis.text.x=element_text(angle=90, hjust=1))
cp + theme(axis.text.x=element_text(angle=-90, hjust=-1))
cp + theme(axis.text.x=element_text(angle=-90, hjust=1))
cp + theme(axis.text.x=element_text(angle=-90, hjust=0))
cor(masterData$communitysat, masterData$registered_vote)
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value))
cp <- cp + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837", name="Correlation")
cp <- cp + scale_x_discrete(labels=varnames)+scale_y_discrete(labels=varnames) +xlab("") + ylab("")
cp + theme(axis.text.x=element_text(angle=-90, hjust=0)) + coord_flip()
m2 <- lm(communitysat~registered_vote, data=masterData)
summary(m2)
masterData$racediffs <- abs(masterData$racediffs)
masterData$seniordiffs <- abs(masterData$seniordiffs)
melted <- select(masterData, -citystate, -year) %>% cor(use="complete.obs") %>% melt()
cp <- ggplot(data=melted, aes(x=Var1, y=Var2, fill=value))
cp <- cp + geom_tile() + scale_fill_gradient2(low="#762A83", high="#1B7837", name="Correlation")
cp
diffscor <- cor(abs(masterData[masterData$year != 2010]$racediffs), masterData[masterData$year != 2010]$communitysat)
library(knitr)
help(purl)
purl("PaperDraft1.Rnw")
purl("PaperDraft1.Rnw", documentation=0)
purl("PaperDraft1.Rnw", documentation=0)
